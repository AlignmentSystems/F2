<!DOCTYPE html>
<html>
<head>
	<title>F2 - Jasmine Unit Tests</title>
	<link rel="shortcut icon" type="image/png" href="libs/jasmine-1.3.1/jasmine_favicon.png">
	<link rel="stylesheet" type="text/css" href="libs/jasmine-1.3.1/jasmine.css">
	<link rel="stylesheet" type="text/css" href="css/page.css">
</head>
<body>
	<div id="test-server-failure">
		The Node.js Test Server is not running. Some tests will not be run.
	</div>
	<div id="tests-skipped" data-count="0"></div>
	<div id="test-fixture">Testing</div>

	<!-- Place code here that needs to be used in tests -->
	<div id="hard-coded-markup" style="display: none;">
		<div id="placeholder-container">
			<div data-f2-appid="com_test_placeholder" data-f2-manifesturl="http://localhost:8080/apps/single" id="placeholder1">
				<span>I'm am child content</span>
			</div>
			<div data-f2-appid="com_test_placeholder2" data-f2-manifesturl="http://localhost:8080/apps/single" data-f2-context='{"didWork":true}' id="placeholder2"></div>
			<div data-f2-appid="com_test_placeholder2" data-f2-manifesturl="http://localhost:8080/apps/single" data-f2-context='{"isDuplicate":true}' id="placeholder3"></div>
		</div>
		<div data-f2-manifesturl="http://localhost:8080/apps/single"></div>
	</div>

	<!-- Node test server -->
	<script src="http://localhost:8080/tests/js/init-node.js"></script>

	<!-- RequireJS -->
	<script src="libs/require.js"></script>
	<script>

		// Define some globals for the tests
		DEFAULT_TIMEOUT = 5000;

		require.config({
			paths: {
				'domReady': 'libs/domReady',

				// Jasmine
				'jasmine': 'libs/jasmine-1.3.1/jasmine',
				'jasmine-async': 'libs/jasmine-1.3.1/jasmine.async.min',
				'jasmine-html': 'libs/jasmine-1.3.1/jasmine-html',
				'console-reporter': 'libs/console-runner',
				'phantom-reporter': '../node_modules/grunt-contrib-jasmine/tasks/jasmine/reporters/PhantomReporter',

				// F2
				'F2': '../dist/f2',

				// Preloaded Apps
				'com_test_placeholder': 'js/apps/com_test_placeholder'
			},
			shim: {
				'jasmine': {
					exports: 'jasmine'
				},
				'jasmine-async': {
					deps: ['jasmine'],
					exports: 'AsyncSpec'
				},
				'jasmine-html': {
					deps: ['jasmine'],
					exports: 'jasmine.HtmlReporter'
				},
				'console-reporter': {
					deps: ['jasmine'],
					exports: 'jasmine.ConsoleReporter'
				},
				'phantom-reporter': {
					deps: ['jasmine']
				}
			}
		});

		require([
			'domReady!',

			// Jasmine
			'jasmine',
			'jasmine-async',
			'jasmine-html',
			'console-reporter',
			'phantom-reporter',

			// Jasmine Specs
			'js/specs/appPlaceholders.spec.js',
			'js/specs/globals.spec.js',
			'js/specs/amd.spec.js',
			'js/specs/f2.events.spec.js',
			//'js/specs/f2.ui.spec.js',
			'js/specs/f2.spec.js',
			'js/specs/f2.schemas.spec.js'
		], function(document, jasmine, __jasmineAsync__, HtmlReporter, ConsoleReporter, __phantomReporter__) {

			var jasmineEnv = jasmine.getEnv();
			jasmineEnv.updateInterval = 1000;

			var htmlReporter = new HtmlReporter();

			jasmineEnv.addReporter(new ConsoleReporter());
			jasmineEnv.addReporter(htmlReporter);

			jasmineEnv.specFilter = function(spec) {
				return htmlReporter.specFilter(spec);
			};

			// allow F2 to be reloaded on the fly
			window.F2_TESTING_MODE = true;

			// defined by the node test server, if it is running
			if (typeof window.F2_NODE_TEST_SERVER === 'undefined') {
				window.F2_NODE_TEST_SERVER = false; // just so we don't need to check for 'undefined' elsewhere
				document.getElementById('test-server-failure').style.display = 'block';
			}

			jasmineEnv.execute();

		});

	</script>

</body>
</html>
