/*! F2 - v2.0.0 - 03-20-2014 - See below for copyright and license */

!function(){function noop(){}if("function"!=typeof define||!define.amd)throw"F2 did not detect an AMD loader.";("undefined"==typeof console||"undefined"==typeof console.log)&&(console={assert:noop,clear:noop,count:noop,debug:noop,dir:noop,dirxml:noop,error:noop,exception:noop,group:noop,groupCollapsed:noop,groupEnd:noop,info:noop,log:noop,markTimeline:noop,profile:noop,profileEnd:noop,table:noop,time:noop,timeEnd:noop,timeStamp:noop,trace:noop,warn:noop});var Lib={},Helpers={},_exports={},_module={exports:{}},_window={document:window.document,XMLHttpRequest:window.XMLHttpRequest,ActiveXObject:window.ActiveXObject,XDomainRequest:window.XDomainRequest};!function(exports,window,f2Window,module){(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v={}.toString,w="function"==typeof define&&define.amd,x="object"==typeof exports&&exports,y='{"A":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',z=new Date(-0xc782b5b800cec);try{z=-109252==z.getUTCFullYear()&&0===z.getUTCMonth()&&1==z.getUTCDate()&&10==z.getUTCHours()&&37==z.getUTCMinutes()&&6==z.getUTCSeconds()&&708==z.getUTCMilliseconds()}catch(A){}if(z||(s=Math.floor,t=[0,31,59,90,120,151,181,212,243,273,304,334],u=function(a,b){return t[b]+365*(a-1970)+s((a-1969+(b=+(b>1)))/4)-s((a-1901+b)/100)+s((a-1601+b)/400)}),w||x?(w&&define("json",x={}),"object"==typeof JSON&&JSON&&(x.stringify=JSON.stringify,x.parse=JSON.parse)):x=this.JSON||(this.JSON={}),d="function"==typeof x.stringify&&!u){(z=function(){return 1}).toJSON=z;try{d="0"===x.stringify(0)&&"0"===x.stringify(new Number)&&'""'==x.stringify(new String)&&x.stringify(v)===c&&x.stringify(c)===c&&x.stringify()===c&&"1"===x.stringify(z)&&"[1]"==x.stringify([z])&&"[null]"==x.stringify([c])&&"null"==x.stringify(null)&&"[null,null,null]"==x.stringify([c,v,null])&&x.stringify({result:[z,!0,!1,null,"\x00\b\n\f\r	"]})==y&&"1"===x.stringify(null,z)&&"[\n 1,\n 2\n]"==x.stringify([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==x.stringify(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==x.stringify(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==x.stringify(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==x.stringify(new Date(-1))}catch(A){d=!1}}if("function"==typeof x.parse)try{if(0===x.parse("0")&&!x.parse(!1)&&(z=x.parse(y),i=5==z.A.length&&1==z.A[0])){try{i=!x.parse('"	"')}catch(A){}if(i)try{i=1!=x.parse("01")}catch(A){}}}catch(A){i=!1}z=y=null,d&&i||((a={}.hasOwnProperty)||(a=function(b){var c,d={};return(d.__proto__=null,d.__proto__={toString:1},d).toString!=v?a=function(a){var b=this.__proto__,c=a in(this.__proto__=null,this);return this.__proto__=b,c}:(c=d.constructor,a=function(a){var b=(this.constructor||c).prototype;return a in this&&!(a in b&&this[a]===b[a])}),d=null,a.call(this,b)}),b=function(b,c){var d,e,f,g,h=0;(d=function(){this.valueOf=0}).prototype.valueOf=0,e=new d;for(f in e)a.call(e,f)&&h++;return d=e=null,h?g=2==h?function(b,c){var d,e={},f="[object Function]"==v.call(b);for(d in b)f&&"prototype"==d||a.call(e,d)||!(e[d]=1)||!a.call(b,d)||c(d)}:function(b,c){var d,e,f="[object Function]"==v.call(b);for(d in b)f&&"prototype"==d||!a.call(b,d)||(e="constructor"===d)||c(d);(e||a.call(b,d="constructor"))&&c(d)}:(e=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],g=function(b,c){var d,f,g="[object Function]"==v.call(b);for(d in b)g&&"prototype"==d||!a.call(b,d)||c(d);for(f=e.length;d=e[--f];a.call(b,d)&&c(d));}),g(b,c)},d||(e={"\\":"\\\\",'"':'\\"',"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t"},f=function(a,b){return("000000"+(b||0)).slice(-a)},g=function(a){for(var b,c='"',d=0;b=a.charAt(d);d++)c+='\\"\b\f\n\r	'.indexOf(b)>-1?e[b]:" ">b?"\\u00"+f(2,b.charCodeAt(0).toString(16)):b;return c+'"'},h=function(d,e,i,j,k,l,m){var n,o,p,q,r,t,w,x,y,z,A,B,C,D,E,F=e[d];if("object"==typeof F&&F)if(n=v.call(F),"[object Date]"!=n||a.call(F,"toJSON"))"function"==typeof F.toJSON&&("[object Number]"!=n&&"[object String]"!=n&&"[object Array]"!=n||a.call(F,"toJSON"))&&(F=F.toJSON(d));else if(F>-1/0&&1/0>F){if(u){for(q=s(F/864e5),o=s(q/365.2425)+1970-1;u(o+1,0)<=q;o++);for(p=s((q-u(o,0))/30.42);u(o,p+1)<=q;p++);q=1+q-u(o,p),r=(F%864e5+864e5)%864e5,t=s(r/36e5)%24,w=s(r/6e4)%60,x=s(r/1e3)%60,y=r%1e3}else o=F.getUTCFullYear(),p=F.getUTCMonth(),q=F.getUTCDate(),t=F.getUTCHours(),w=F.getUTCMinutes(),x=F.getUTCSeconds(),y=F.getUTCMilliseconds();F=(0>=o||o>=1e4?(0>o?"-":"+")+f(6,0>o?-o:o):f(4,o))+"-"+f(2,p+1)+"-"+f(2,q)+"T"+f(2,t)+":"+f(2,w)+":"+f(2,x)+"."+f(3,y)+"Z"}else F=null;if(i&&(F=i.call(e,d,F)),null===F)return"null";if(n=v.call(F),"[object Boolean]"==n)return""+F;if("[object Number]"==n)return F>-1/0&&1/0>F?""+F:"null";if("[object String]"==n)return g(F);if("object"==typeof F){for(C=m.length;C--;)if(m[C]===F)throw TypeError();if(m.push(F),z=[],D=l,l+=k,"[object Array]"==n){for(B=0,C=F.length;C>B;E||(E=!0),B++)A=h(B,F,i,j,k,l,m),z.push(A===c?"null":A);return E?k?"[\n"+l+z.join(",\n"+l)+"\n"+D+"]":"["+z.join(",")+"]":"[]"}return b(j||F,function(a){var b=h(a,F,i,j,k,l,m);b!==c&&z.push(g(a)+":"+(k?" ":"")+b),E||(E=!0)}),E?k?"{\n"+l+z.join(",\n"+l)+"\n"+D+"}":"{"+z.join(",")+"}":"{}"}},x.stringify=function(a,b,c){var d,e,f,g,i,j;if("function"==typeof b||"object"==typeof b&&b)if("[object Function]"==v.call(b))e=b;else if("[object Array]"==v.call(b))for(f={},g=0,i=b.length;i>g;j=b[g++],("[object String]"==v.call(j)||"[object Number]"==v.call(j))&&(f[j]=1));if(c)if("[object Number]"==v.call(c)){if((c-=c%1)>0)for(d="",c>10&&(c=10);d.length<c;d+=" ");}else"[object String]"==v.call(c)&&(d=c.length<=10?c:c.slice(0,10));return h("",(j={},j[""]=a,j),e,f,d,"",[])}),i||(j=String.fromCharCode,k={"\\":"\\",'"':'"',"/":"/",b:"\b",t:"	",n:"\n",f:"\f",r:"\r"},l=function(){throw q=r=null,SyntaxError()},m=function(){for(var a,b,c,d,e,f=r,g=f.length;g>q;)if(a=f.charAt(q),"	\r\n ".indexOf(a)>-1)q++;else{if("{}[]:,".indexOf(a)>-1)return q++,a;if('"'==a){for(b="@",q++;g>q;)if(a=f.charAt(q)," ">a)l();else if("\\"==a)if(a=f.charAt(++q),'\\"/btnfr'.indexOf(a)>-1)b+=k[a],q++;else if("u"==a){for(c=++q,d=q+4;d>q;q++)a=f.charAt(q),a>="0"&&"9">=a||a>="a"&&"f">=a||a>="A"&&"F">=a||l();b+=j("0x"+f.slice(c,q))}else l();else{if('"'==a)break;b+=a,q++}if('"'==f.charAt(q))return q++,b;l()}else{if(c=q,"-"==a&&(e=!0,a=f.charAt(++q)),a>="0"&&"9">=a){for("0"==a&&(a=f.charAt(q+1),a>="0"&&"9">=a)&&l(),e=!1;g>q&&(a=f.charAt(q),a>="0"&&"9">=a);q++);if("."==f.charAt(q)){for(d=++q;g>d&&(a=f.charAt(d),a>="0"&&"9">=a);d++);d==q&&l(),q=d}if(a=f.charAt(q),"e"==a||"E"==a){for(a=f.charAt(++q),("+"==a||"-"==a)&&q++,d=q;g>d&&(a=f.charAt(d),a>="0"&&"9">=a);d++);d==q&&l(),q=d}return+f.slice(c,q)}if(e&&l(),"true"==f.slice(q,q+4))return q+=4,!0;if("false"==f.slice(q,q+5))return q+=5,!1;if("null"==f.slice(q,q+4))return q+=4,null;l()}}return"$"},n=function(a){var b,c;if("$"==a&&l(),"string"==typeof a){if("@"==a.charAt(0))return a.slice(1);if("["==a){for(b=[];a=m(),"]"!=a;c||(c=!0))c&&(","==a?(a=m(),"]"==a&&l()):l()),","==a&&l(),b.push(n(a));return b}if("{"==a){for(b={};a=m(),"}"!=a;c||(c=!0))c&&(","==a?(a=m(),"}"==a&&l()):l()),(","==a||"string"!=typeof a||"@"!=a.charAt(0)||":"!=m())&&l(),b[a.slice(1)]=n(m());return b}l()}return a},p=function(a,b,d){var e=o(a,b,d);e===c?delete a[b]:a[b]=e},o=function(a,c,d){var e,f=a[c];if("object"==typeof f&&f)if("[object Array]"==v.call(f))for(e=f.length;e--;)p(f,e,d);else b(f,function(a){p(f,a,d)});return d.call(a,c,f)},x.parse=function(a,b){q=0,r=a;var c=n(m());return"$"!=m()&&l(),q=r=null,b&&"[object Function]"==v.call(b)?o((z={},z[""]=c,z),"",b):c}))}).call(this),exports.JSON={stringify:exports.stringify,parse:exports.parse},delete exports.stringify,delete exports.parse,!function(a,b,c){"undefined"!=typeof module&&module.exports?module.exports=c():"function"==typeof define&&define.amd?define(c):b[a]=c()}("reqwest",this,function(){function handleReadyState(a,b,c){return function(){return a._aborted?c(a.request):void(a.request&&4==a.request[readyState]&&(a.request.onreadystatechange=noop,twoHundo.test(a.request.status)?b(a.request):c(a.request)))}}function setHeaders(a,b){var c,d=b.headers||{};d.Accept=d.Accept||defaultHeaders.accept[b.type]||defaultHeaders.accept["*"],b.crossOrigin||d[requestedWith]||(d[requestedWith]=defaultHeaders.requestedWith),d[contentType]||(d[contentType]=b.contentType||defaultHeaders.contentType);for(c in d)d.hasOwnProperty(c)&&"setRequestHeader"in a&&a.setRequestHeader(c,d[c])}function setCredentials(a,b){"undefined"!=typeof b.withCredentials&&"undefined"!=typeof a.withCredentials&&(a.withCredentials=!!b.withCredentials)}function generalCallback(a){lastValue=a}function urlappend(a,b){return a+(/\?/.test(a)?"&":"?")+b}function handleJsonp(a,b,c,d){var e=uniqid++,f=a.jsonpCallback||"callback",g=a.jsonpCallbackName||reqwest.getcallbackPrefix(e),h=new RegExp("((^|\\?|&)"+f+")=([^&]+)"),i=d.match(h),j=doc.createElement("script"),k=0,l=-1!==navigator.userAgent.indexOf("MSIE 10.0");return i?"?"===i[3]?d=d.replace(h,"$1="+g):g=i[3]:d=urlappend(d,f+"="+g),win[g]=generalCallback,j.type="text/javascript",j.src=d,j.async=!0,"undefined"==typeof j.onreadystatechange||l||(j.event="onclick",j.htmlFor=j.id="_reqwest_"+e),j.onload=j.onreadystatechange=function(){return j[readyState]&&"complete"!==j[readyState]&&"loaded"!==j[readyState]||k?!1:(j.onload=j.onreadystatechange=null,j.onclick&&j.onclick(),b(lastValue),lastValue=void 0,head.removeChild(j),void(k=1))},head.appendChild(j),{abort:function(){j.onload=j.onreadystatechange=null,c({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(j),k=1}}}function getRequest(a,b){var c,d=this.o,e=(d.method||"GET").toUpperCase(),f="string"==typeof d?d:d.url,g=d.processData!==!1&&d.data&&"string"!=typeof d.data?reqwest.toQueryString(d.data):d.data||null,h=!1;return"jsonp"!=d.type&&"GET"!=e||!g||(f=urlappend(f,g),g=null),"jsonp"==d.type?handleJsonp(d,a,b,f):(c=xhr(d),c.open(e,f,d.async===!1?!1:!0),setHeaders(c,d),setCredentials(c,d),win[xDomainRequest]&&c instanceof win[xDomainRequest]?(c.onload=a,c.onerror=b,c.onprogress=function(){},h=!0):c.onreadystatechange=handleReadyState(this,a,b),d.before&&d.before(c),h?setTimeout(function(){c.send(g)},200):c.send(g),c)}function Reqwest(a,b){this.o=a,this.fn=b,init.apply(this,arguments)}function setType(a){var b=a.match(/\.(json|jsonp|html|xml)(\?|$)/);return b?b[1]:"js"}function init(o,fn){function complete(a){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(a)}function success(resp){if(resp){resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=win.JSON?win.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}}function error(a,b,c){for(a=self.request,self._responseArgs.resp=a,self._responseArgs.msg=b,self._responseArgs.t=c,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(a,b,c);complete(a)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this,type=o.type||setType(this.url);fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){self.abort()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(a,b){return new Reqwest(a,b)}function normalize(a){return a?a.replace(/\r?\n/g,"\r\n"):""}function serial(a,b){var c,d,e,f,g=a.name,h=a.tagName.toLowerCase(),i=function(a){a&&!a.disabled&&b(g,normalize(a.attributes.value&&a.attributes.value.specified?a.value:a.text))};if(!a.disabled&&g)switch(h){case"input":/reset|button|image|file/i.test(a.type)||(c=/checkbox/i.test(a.type),d=/radio/i.test(a.type),e=a.value,(!(c||d)||a.checked)&&b(g,normalize(c&&""===e?"on":e)));break;case"textarea":b(g,normalize(a.value));break;case"select":if("select-one"===a.type.toLowerCase())i(a.selectedIndex>=0?a.options[a.selectedIndex]:null);else for(f=0;a.length&&f<a.length;f++)a.options[f].selected&&i(a.options[f])}}function eachFormElement(){var a,b,c=this,d=function(a,b){var d,e,f;for(d=0;d<b.length;d++)for(f=a[byTag](b[d]),e=0;e<f.length;e++)serial(f[e],c)};for(b=0;b<arguments.length;b++)a=arguments[b],/input|select|textarea/i.test(a.tagName)&&serial(a,c),d(a,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var a={};return eachFormElement.apply(function(b,c){b in a?(a[b]&&!isArray(a[b])&&(a[b]=[a[b]]),a[b].push(c)):a[b]=c},arguments),a}function buildParams(a,b,c,d){var e,f,g,h=/\[\]$/;if(isArray(b))for(f=0;b&&f<b.length;f++)g=b[f],c||h.test(a)?d(a,g):buildParams(a+"["+("object"==typeof g?f:"")+"]",g,c,d);else if(b&&"[object Object]"===b.toString())for(e in b)buildParams(a+"["+e+"]",b[e],c,d);else d(a,b)}var win=window,doc=document,twoHundo=/^20\d$/,byTag="getElementsByTagName",readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",head=doc[byTag]("head")[0],uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(a){return a instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(a){if(a.crossOrigin===!0){var b=win[xmlHttpRequest]?new XMLHttpRequest:null;if(b&&"withCredentials"in b)return b;if(win[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return win[xmlHttpRequest]?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(a){return a}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(a,b){return a=a||function(){},b=b||function(){},this._fulfilled?this._responseArgs.resp=a(this._responseArgs.resp):this._erred?b(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(a),this._errorHandlers.push(b)),this},always:function(a){return this._fulfilled||this._erred?a(this._responseArgs.resp):this._completeHandlers.push(a),this},fail:function(a){return this._erred?a(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(a),this}},reqwest.serializeArray=function(){var a=[];return eachFormElement.apply(function(b,c){a.push({name:b,value:c})},arguments),a},reqwest.serialize=function(){if(0===arguments.length)return"";var a,b,c=Array.prototype.slice.call(arguments,0);return a=c.pop(),a&&a.nodeType&&c.push(a)&&(a=null),a&&(a=a.type),b="map"==a?serializeHash:"array"==a?reqwest.serializeArray:serializeQueryString,b.apply(null,c)},reqwest.toQueryString=function(a,b){var c,d,e=b||!1,f=[],g=encodeURIComponent,h=function(a,b){b="function"==typeof b?b():null==b?"":b,f[f.length]=g(a)+"="+g(b)};if(isArray(a))for(d=0;a&&d<a.length;d++)h(a[d].name,a[d].value);else for(c in a)buildParams(c,a[c],e,h);return f.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(a,b){return a&&(a.type&&(a.method=a.type)&&delete a.type,a.dataType&&(a.type=a.dataType),a.jsonpCallback&&(a.jsonpCallbackName=a.jsonpCallback)&&delete a.jsonpCallback,a.jsonp&&(a.jsonpCallback=a.jsonp)),new Reqwest(a,b)},reqwest.ajaxSetup=function(a){a=a||{};for(var b in a)globalSetupOptions[b]=a[b]},reqwest}),exports.reqwest=module.exports,module={exports:{}},function(a){"use strict";function b(a,c){if(a===c)return!0;if("object"==typeof a&&"object"==typeof c){if(Array.isArray(a)!==Array.isArray(c))return!1;if(Array.isArray(a)){if(a.length!==c.length)return!1;for(var d=0;d<a.length;d++)if(!b(a[d],c[d]))return!1}else{var e;for(e in a)if(void 0===c[e]&&void 0!==a[e])return!1;for(e in c)if(void 0===a[e]&&void 0!==c[e])return!1;for(e in a)if(!b(a[e],c[e]))return!1}return!0}return!1}function c(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function d(a,b){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return b=c(b||""),a=c(a||""),b&&a?(b.protocol||a.protocol)+(b.protocol||b.authority?b.authority:a.authority)+d(b.protocol||b.authority||"/"===b.pathname.charAt(0)?b.pathname:b.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+b.pathname:a.pathname)+(b.protocol||b.authority||b.pathname?b.search:b.search||a.search)+b.hash:null}function e(a){return a.split("#")[0]}function f(a,b){if(void 0===b?b=a.id:"string"==typeof a.id&&(b=d(b,a.id),a.id=b),"object"==typeof a)if(Array.isArray(a))for(var c=0;c<a.length;c++)f(a[c],b);else if("string"==typeof a.$ref)a.$ref=d(b,a.$ref);else for(var e in a)"enum"!==e&&f(a[e],b)}function g(a,b,c,d,e){if(void 0===a)throw new Error("No code supplied for error: "+b);this.code=a,this.message=b,this.dataPath=c||"",this.schemaPath=d||"",this.subErrors=e||null}function h(a,b){if(b.substring(0,a.length)===a){var c=b.substring(a.length);if(b.length>0&&"/"===b.charAt(a.length-1)||"#"===c.charAt(0)||"?"===c.charAt(0))return!0}return!1}function i(a){var b=new j,c=a||"en",g={addFormat:function(){b.addFormat.apply(b,arguments)},language:function(a){return a?(m[a]||(a=a.split("-")[0]),m[a]?(c=a,a):!1):c},addLanguage:function(a,b){var c;for(c in k)b[c]&&!b[k[c]]&&(b[k[c]]=b[c]);var d=a.split("-")[0];if(m[d]){m[a]=Object.create(m[d]);for(c in b)"undefined"==typeof m[d][c]&&(m[d][c]=b[c]),m[a][c]=b[c]}else m[a]=b,m[d]=b;return this},freshApi:function(a){var b=i();return a&&b.language(a),b},validate:function(a,d,e,f){var g=new j(b,!1,m[c],e,f);"string"==typeof d&&(d={$ref:d}),g.addSchema("",d);var h=g.validateAll(a,d,null,null,"");return!h&&f&&(h=g.banUnknownProperties()),this.error=h,this.missing=g.missing,this.valid=null===h,this.valid},validateResult:function(){var a={};return this.validate.apply(a,arguments),a},validateMultiple:function(a,d,e,f){var g=new j(b,!0,m[c],e,f);"string"==typeof d&&(d={$ref:d}),g.addSchema("",d),g.validateAll(a,d,null,null,""),f&&g.banUnknownProperties();var h={};return h.errors=g.errors,h.missing=g.missing,h.valid=0===h.errors.length,h},addSchema:function(){return b.addSchema.apply(b,arguments)},getSchema:function(){return b.getSchema.apply(b,arguments)},getSchemaMap:function(){return b.getSchemaMap.apply(b,arguments)},getSchemaUris:function(){return b.getSchemaUris.apply(b,arguments)},getMissingUris:function(){return b.getMissingUris.apply(b,arguments)},dropSchemas:function(){b.dropSchemas.apply(b,arguments)},reset:function(){b.reset(),this.error=null,this.missing=[],this.valid=!0},missing:[],error:null,valid:!0,normSchema:f,resolveUrl:d,getDocumentUri:e,errorCodes:k};return g}Object.keys||(Object.keys=function(){var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&"function"!=typeof e||null===e)throw new TypeError("Object.keys called on non-object");var f=[];for(var g in e)a.call(e,g)&&f.push(g);if(b)for(var h=0;d>h;h++)a.call(e,c[h])&&f.push(c[h]);return f}}()),Object.create||(Object.create=function(){function a(){}return function(b){if(1!==arguments.length)throw new Error("Object.create implementation only accepts one parameter.");return a.prototype=b,new a}}()),Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(null===this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!==d?d=0:0!==d&&1/0!==d&&d!==-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Object.isFrozen||(Object.isFrozen=function(a){for(var b="tv4_test_frozen_key";a.hasOwnProperty(b);)b+=Math.random();try{return a[b]=!0,delete a[b],!1}catch(c){return!0}});var j=function(a,b,c,d,e){this.missing=[],this.missingMap={},this.formatValidators=a?Object.create(a.formatValidators):{},this.schemas=a?Object.create(a.schemas):{},this.collectMultiple=b,this.errors=[],this.handleError=b?this.collectError:this.returnError,d&&(this.checkRecursive=!0,this.scanned=[],this.scannedFrozen=[],this.scannedFrozenSchemas=[],this.key="tv4_validation_id"),e&&(this.trackUnknownProperties=!0,this.knownPropertyPaths={},this.unknownPropertyPaths={}),this.errorMessages=c};j.prototype.createError=function(a,b,c,d,e){var f=this.errorMessages[a]||l[a];if("string"!=typeof f)return new g(a,"Unknown error code "+a+": "+JSON.stringify(b),c,d,e);var h=f.replace(/\{([^{}]*)\}/g,function(a,c){var d=b[c];return"string"==typeof d||"number"==typeof d?d:a});return new g(a,h,c,d,e)},j.prototype.returnError=function(a){return a},j.prototype.collectError=function(a){return a&&this.errors.push(a),null},j.prototype.prefixErrors=function(a,b,c){for(var d=a;d<this.errors.length;d++)this.errors[d]=this.errors[d].prefixWith(b,c);return this},j.prototype.banUnknownProperties=function(){for(var a in this.unknownPropertyPaths){var b=this.createError(k.UNKNOWN_PROPERTY,{path:a},a,""),c=this.handleError(b);if(c)return c}return null},j.prototype.addFormat=function(a,b){if("object"==typeof a){for(var c in a)this.addFormat(c,a[c]);return this}this.formatValidators[a]=b},j.prototype.getSchema=function(a){var b;if(void 0!==this.schemas[a])return b=this.schemas[a];var c=a,d="";if(-1!==a.indexOf("#")&&(d=a.substring(a.indexOf("#")+1),c=a.substring(0,a.indexOf("#"))),"object"==typeof this.schemas[c]){b=this.schemas[c];var e=decodeURIComponent(d);if(""===e)return b;if("/"!==e.charAt(0))return void 0;for(var f=e.split("/").slice(1),g=0;g<f.length;g++){var h=f[g].replace(/~1/g,"/").replace(/~0/g,"~");if(void 0===b[h]){b=void 0;break}b=b[h]}if(void 0!==b)return b}void 0===this.missing[c]&&(this.missing.push(c),this.missing[c]=c,this.missingMap[c]=c)},j.prototype.searchSchemas=function(a,b){if("string"==typeof a.id&&h(b,a.id)&&void 0===this.schemas[a.id]&&(this.schemas[a.id]=a),"object"==typeof a)for(var c in a)if("enum"!==c)if("object"==typeof a[c])this.searchSchemas(a[c],b);else if("$ref"===c){var d=e(a[c]);d&&void 0===this.schemas[d]&&void 0===this.missingMap[d]&&(this.missingMap[d]=d)}},j.prototype.addSchema=function(a,b){if("undefined"==typeof b){if("object"!=typeof a||"string"!=typeof a.id)return;b=a,a=b.id}(a=e(a)+"#")&&(a=e(a)),this.schemas[a]=b,delete this.missingMap[a],f(b,a),this.searchSchemas(b,a)},j.prototype.getSchemaMap=function(){var a={};for(var b in this.schemas)a[b]=this.schemas[b];return a},j.prototype.getSchemaUris=function(a){var b=[];for(var c in this.schemas)(!a||a.test(c))&&b.push(c);return b},j.prototype.getMissingUris=function(a){var b=[];for(var c in this.missingMap)(!a||a.test(c))&&b.push(c);return b},j.prototype.dropSchemas=function(){this.schemas={},this.reset()},j.prototype.reset=function(){this.missing=[],this.missingMap={},this.errors=[]},j.prototype.validateAll=function(a,b,c,d,e){var f;if(void 0!==b.$ref&&(b=this.getSchema(b.$ref),!b))return null;if(this.checkRecursive&&"object"==typeof a){if(f=!this.scanned.length,a[this.key]&&-1!==a[this.key].indexOf(b))return null;var g;if(Object.isFrozen(a)&&(g=this.scannedFrozen.indexOf(a),-1!==g&&-1!==this.scannedFrozenSchemas[g].indexOf(b)))return null;if(this.scanned.push(a),Object.isFrozen(a))-1===g&&(g=this.scannedFrozen.length,this.scannedFrozen.push(a),this.scannedFrozenSchemas.push([])),this.scannedFrozenSchemas[g].push(b);else{if(!a[this.key])try{Object.defineProperty(a,this.key,{value:[],configurable:!0})}catch(h){a[this.key]=[]}a[this.key].push(b)}}var i=this.errors.length,j=this.validateBasic(a,b,e)||this.validateNumeric(a,b,e)||this.validateString(a,b,e)||this.validateArray(a,b,e)||this.validateObject(a,b,e)||this.validateCombinations(a,b,e)||this.validateFormat(a,b,e)||null;if(f){for(;this.scanned.length;){var k=this.scanned.pop();delete k[this.key]}this.scannedFrozen=[],this.scannedFrozenSchemas=[]}if(j||i!==this.errors.length)for(;c&&c.length||d&&d.length;){var l=c&&c.length?""+c.pop():null,m=d&&d.length?""+d.pop():null;j&&(j=j.prefixWith(l,m)),this.prefixErrors(i,l,m)}return this.handleError(j)},j.prototype.validateFormat=function(a,b){if("string"!=typeof b.format||!this.formatValidators[b.format])return null;var c=this.formatValidators[b.format].call(null,a,b);return"string"==typeof c||"number"==typeof c?this.createError(k.FORMAT_CUSTOM,{message:c}).prefixWith(null,"format"):c&&"object"==typeof c?this.createError(k.FORMAT_CUSTOM,{message:c.message||"?"},c.dataPath||null,c.schemaPath||"/format"):null},j.prototype.validateBasic=function(a,b,c){var d;return(d=this.validateType(a,b,c))?d.prefixWith(null,"type"):(d=this.validateEnum(a,b,c))?d.prefixWith(null,"type"):null},j.prototype.validateType=function(a,b){if(void 0===b.type)return null;var c=typeof a;null===a?c="null":Array.isArray(a)&&(c="array");var d=b.type;"object"!=typeof d&&(d=[d]);for(var e=0;e<d.length;e++){var f=d[e];if(f===c||"integer"===f&&"number"===c&&a%1===0)return null}return this.createError(k.INVALID_TYPE,{type:c,expected:d.join("/")})},j.prototype.validateEnum=function(a,c){if(void 0===c["enum"])return null;for(var d=0;d<c["enum"].length;d++){var e=c["enum"][d];if(b(a,e))return null}return this.createError(k.ENUM_MISMATCH,{value:"undefined"!=typeof JSON?JSON.stringify(a):a})},j.prototype.validateNumeric=function(a,b,c){return this.validateMultipleOf(a,b,c)||this.validateMinMax(a,b,c)||null},j.prototype.validateMultipleOf=function(a,b){var c=b.multipleOf||b.divisibleBy;return void 0===c?null:"number"==typeof a&&a%c!==0?this.createError(k.NUMBER_MULTIPLE_OF,{value:a,multipleOf:c}):null},j.prototype.validateMinMax=function(a,b){if("number"!=typeof a)return null;if(void 0!==b.minimum){if(a<b.minimum)return this.createError(k.NUMBER_MINIMUM,{value:a,minimum:b.minimum}).prefixWith(null,"minimum");if(b.exclusiveMinimum&&a===b.minimum)return this.createError(k.NUMBER_MINIMUM_EXCLUSIVE,{value:a,minimum:b.minimum}).prefixWith(null,"exclusiveMinimum")}if(void 0!==b.maximum){if(a>b.maximum)return this.createError(k.NUMBER_MAXIMUM,{value:a,maximum:b.maximum}).prefixWith(null,"maximum");if(b.exclusiveMaximum&&a===b.maximum)return this.createError(k.NUMBER_MAXIMUM_EXCLUSIVE,{value:a,maximum:b.maximum}).prefixWith(null,"exclusiveMaximum")}return null},j.prototype.validateString=function(a,b,c){return this.validateStringLength(a,b,c)||this.validateStringPattern(a,b,c)||null},j.prototype.validateStringLength=function(a,b){return"string"!=typeof a?null:void 0!==b.minLength&&a.length<b.minLength?this.createError(k.STRING_LENGTH_SHORT,{length:a.length,minimum:b.minLength}).prefixWith(null,"minLength"):void 0!==b.maxLength&&a.length>b.maxLength?this.createError(k.STRING_LENGTH_LONG,{length:a.length,maximum:b.maxLength}).prefixWith(null,"maxLength"):null},j.prototype.validateStringPattern=function(a,b){if("string"!=typeof a||void 0===b.pattern)return null;var c=new RegExp(b.pattern);return c.test(a)?null:this.createError(k.STRING_PATTERN,{pattern:b.pattern}).prefixWith(null,"pattern")},j.prototype.validateArray=function(a,b,c){return Array.isArray(a)?this.validateArrayLength(a,b,c)||this.validateArrayUniqueItems(a,b,c)||this.validateArrayItems(a,b,c)||null:null},j.prototype.validateArrayLength=function(a,b){var c;return void 0!==b.minItems&&a.length<b.minItems&&(c=this.createError(k.ARRAY_LENGTH_SHORT,{length:a.length,minimum:b.minItems}).prefixWith(null,"minItems"),this.handleError(c))?c:void 0!==b.maxItems&&a.length>b.maxItems&&(c=this.createError(k.ARRAY_LENGTH_LONG,{length:a.length,maximum:b.maxItems}).prefixWith(null,"maxItems"),this.handleError(c))?c:null},j.prototype.validateArrayUniqueItems=function(a,c){if(c.uniqueItems)for(var d=0;d<a.length;d++)for(var e=d+1;e<a.length;e++)if(b(a[d],a[e])){var f=this.createError(k.ARRAY_UNIQUE,{match1:d,match2:e}).prefixWith(null,"uniqueItems");if(this.handleError(f))return f}return null},j.prototype.validateArrayItems=function(a,b,c){if(void 0===b.items)return null;var d,e;if(Array.isArray(b.items)){for(e=0;e<a.length;e++)if(e<b.items.length){if(d=this.validateAll(a[e],b.items[e],[e],["items",e],c+"/"+e))return d}else if(void 0!==b.additionalItems)if("boolean"==typeof b.additionalItems){if(!b.additionalItems&&(d=this.createError(k.ARRAY_ADDITIONAL_ITEMS,{}).prefixWith(""+e,"additionalItems"),this.handleError(d)))return d}else if(d=this.validateAll(a[e],b.additionalItems,[e],["additionalItems"],c+"/"+e))return d}else for(e=0;e<a.length;e++)if(d=this.validateAll(a[e],b.items,[e],["items"],c+"/"+e))return d;return null},j.prototype.validateObject=function(a,b,c){return"object"!=typeof a||null===a||Array.isArray(a)?null:this.validateObjectMinMaxProperties(a,b,c)||this.validateObjectRequiredProperties(a,b,c)||this.validateObjectProperties(a,b,c)||this.validateObjectDependencies(a,b,c)||null},j.prototype.validateObjectMinMaxProperties=function(a,b){var c,d=Object.keys(a);return void 0!==b.minProperties&&d.length<b.minProperties&&(c=this.createError(k.OBJECT_PROPERTIES_MINIMUM,{propertyCount:d.length,minimum:b.minProperties}).prefixWith(null,"minProperties"),this.handleError(c))?c:void 0!==b.maxProperties&&d.length>b.maxProperties&&(c=this.createError(k.OBJECT_PROPERTIES_MAXIMUM,{propertyCount:d.length,maximum:b.maxProperties}).prefixWith(null,"maxProperties"),this.handleError(c))?c:null},j.prototype.validateObjectRequiredProperties=function(a,b){if(void 0!==b.required)for(var c=0;c<b.required.length;c++){var d=b.required[c];if(void 0===a[d]){var e=this.createError(k.OBJECT_REQUIRED,{key:d}).prefixWith(null,""+c).prefixWith(null,"required");if(this.handleError(e))return e}}return null},j.prototype.validateObjectProperties=function(a,b,c){var d;for(var e in a){var f=c+"/"+e.replace(/~/g,"~0").replace(/\//g,"~1"),g=!1;if(void 0!==b.properties&&void 0!==b.properties[e]&&(g=!0,d=this.validateAll(a[e],b.properties[e],[e],["properties",e],f)))return d;if(void 0!==b.patternProperties)for(var h in b.patternProperties){var i=new RegExp(h);if(i.test(e)&&(g=!0,d=this.validateAll(a[e],b.patternProperties[h],[e],["patternProperties",h],f)))return d}if(g)this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]);else if(void 0!==b.additionalProperties){if(this.trackUnknownProperties&&(this.knownPropertyPaths[f]=!0,delete this.unknownPropertyPaths[f]),"boolean"==typeof b.additionalProperties){if(!b.additionalProperties&&(d=this.createError(k.OBJECT_ADDITIONAL_PROPERTIES,{}).prefixWith(e,"additionalProperties"),this.handleError(d)))return d
}else if(d=this.validateAll(a[e],b.additionalProperties,[e],["additionalProperties"],f))return d}else this.trackUnknownProperties&&!this.knownPropertyPaths[f]&&(this.unknownPropertyPaths[f]=!0)}return null},j.prototype.validateObjectDependencies=function(a,b,c){var d;if(void 0!==b.dependencies)for(var e in b.dependencies)if(void 0!==a[e]){var f=b.dependencies[e];if("string"==typeof f){if(void 0===a[f]&&(d=this.createError(k.OBJECT_DEPENDENCY_KEY,{key:e,missing:f}).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(Array.isArray(f))for(var g=0;g<f.length;g++){var h=f[g];if(void 0===a[h]&&(d=this.createError(k.OBJECT_DEPENDENCY_KEY,{key:e,missing:h}).prefixWith(null,""+g).prefixWith(null,e).prefixWith(null,"dependencies"),this.handleError(d)))return d}else if(d=this.validateAll(a,f,[],["dependencies",e],c))return d}return null},j.prototype.validateCombinations=function(a,b,c){return this.validateAllOf(a,b,c)||this.validateAnyOf(a,b,c)||this.validateOneOf(a,b,c)||this.validateNot(a,b,c)||null},j.prototype.validateAllOf=function(a,b,c){if(void 0===b.allOf)return null;for(var d,e=0;e<b.allOf.length;e++){var f=b.allOf[e];if(d=this.validateAll(a,f,[],["allOf",e],c))return d}return null},j.prototype.validateAnyOf=function(a,b,c){if(void 0===b.anyOf)return null;var d,e,f=[],g=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var h=!0,i=0;i<b.anyOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var j=b.anyOf[i],l=this.errors.length,m=this.validateAll(a,j,[],["anyOf",i],c);if(null===m&&l===this.errors.length){if(this.errors=this.errors.slice(0,g),this.trackUnknownProperties){for(var n in this.knownPropertyPaths)e[n]=!0,delete d[n];for(var o in this.unknownPropertyPaths)e[o]||(d[o]=!0);console.log("Continuing"),h=!1;continue}return null}m&&f.push(m.prefixWith(null,""+i).prefixWith(null,"anyOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),h?(f=f.concat(this.errors.slice(g)),this.errors=this.errors.slice(0,g),this.createError(k.ANY_OF_MISSING,{},"","/anyOf",f)):void 0},j.prototype.validateOneOf=function(a,b,c){if(void 0===b.oneOf)return null;var d,e,f=null,g=[],h=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths);for(var i=0;i<b.oneOf.length;i++){this.trackUnknownProperties&&(this.unknownPropertyPaths={},this.knownPropertyPaths={});var j=b.oneOf[i],l=this.errors.length,m=this.validateAll(a,j,[],["oneOf",i],c);if(null===m&&l===this.errors.length){if(null!==f)return this.errors=this.errors.slice(0,h),this.createError(k.ONE_OF_MULTIPLE,{index1:f,index2:i},"","/oneOf");if(f=i,this.trackUnknownProperties){for(var n in this.knownPropertyPaths)e[n]=!0,delete d[n];for(var o in this.unknownPropertyPaths)e[o]||(d[o]=!0)}}else m&&g.push(m.prefixWith(null,""+i).prefixWith(null,"oneOf"))}return this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===f?(g=g.concat(this.errors.slice(h)),this.errors=this.errors.slice(0,h),this.createError(k.ONE_OF_MISSING,{},"","/oneOf",g)):(this.errors=this.errors.slice(0,h),null)},j.prototype.validateNot=function(a,b,c){if(void 0===b.not)return null;var d,e,f=this.errors.length;this.trackUnknownProperties&&(d=this.unknownPropertyPaths,e=this.knownPropertyPaths,this.unknownPropertyPaths={},this.knownPropertyPaths={});var g=this.validateAll(a,b.not,null,null,c),h=this.errors.slice(f);return this.errors=this.errors.slice(0,f),this.trackUnknownProperties&&(this.unknownPropertyPaths=d,this.knownPropertyPaths=e),null===g&&0===h.length?this.createError(k.NOT_PASSED,{},"","/not"):null};var k={INVALID_TYPE:0,ENUM_MISMATCH:1,ANY_OF_MISSING:10,ONE_OF_MISSING:11,ONE_OF_MULTIPLE:12,NOT_PASSED:13,NUMBER_MULTIPLE_OF:100,NUMBER_MINIMUM:101,NUMBER_MINIMUM_EXCLUSIVE:102,NUMBER_MAXIMUM:103,NUMBER_MAXIMUM_EXCLUSIVE:104,STRING_LENGTH_SHORT:200,STRING_LENGTH_LONG:201,STRING_PATTERN:202,OBJECT_PROPERTIES_MINIMUM:300,OBJECT_PROPERTIES_MAXIMUM:301,OBJECT_REQUIRED:302,OBJECT_ADDITIONAL_PROPERTIES:303,OBJECT_DEPENDENCY_KEY:304,ARRAY_LENGTH_SHORT:400,ARRAY_LENGTH_LONG:401,ARRAY_UNIQUE:402,ARRAY_ADDITIONAL_ITEMS:403,FORMAT_CUSTOM:500,UNKNOWN_PROPERTY:1e3},l={INVALID_TYPE:"invalid type: {type} (expected {expected})",ENUM_MISMATCH:"No enum match for: {value}",ANY_OF_MISSING:'Data does not match any schemas from "anyOf"',ONE_OF_MISSING:'Data does not match any schemas from "oneOf"',ONE_OF_MULTIPLE:'Data is valid against more than one schema from "oneOf": indices {index1} and {index2}',NOT_PASSED:'Data matches schema from "not"',NUMBER_MULTIPLE_OF:"Value {value} is not a multiple of {multipleOf}",NUMBER_MINIMUM:"Value {value} is less than minimum {minimum}",NUMBER_MINIMUM_EXCLUSIVE:"Value {value} is equal to exclusive minimum {minimum}",NUMBER_MAXIMUM:"Value {value} is greater than maximum {maximum}",NUMBER_MAXIMUM_EXCLUSIVE:"Value {value} is equal to exclusive maximum {maximum}",STRING_LENGTH_SHORT:"String is too short ({length} chars), minimum {minimum}",STRING_LENGTH_LONG:"String is too long ({length} chars), maximum {maximum}",STRING_PATTERN:"String does not match pattern: {pattern}",OBJECT_PROPERTIES_MINIMUM:"Too few properties defined ({propertyCount}), minimum {minimum}",OBJECT_PROPERTIES_MAXIMUM:"Too many properties defined ({propertyCount}), maximum {maximum}",OBJECT_REQUIRED:"Missing required property: {key}",OBJECT_ADDITIONAL_PROPERTIES:"Additional properties not allowed",OBJECT_DEPENDENCY_KEY:"Dependency failed - key must exist: {missing} (due to key: {key})",ARRAY_LENGTH_SHORT:"Array is too short ({length}), minimum {minimum}",ARRAY_LENGTH_LONG:"Array is too long ({length}), maximum {maximum}",ARRAY_UNIQUE:"Array items are not unique (indices {match1} and {match2})",ARRAY_ADDITIONAL_ITEMS:"Additional items not allowed",FORMAT_CUSTOM:"Format validation failed ({message})",UNKNOWN_PROPERTY:"Unknown property (not in schema)"};g.prototype=new Error,g.prototype.prefixWith=function(a,b){if(null!==a&&(a=a.replace(/~/g,"~0").replace(/\//g,"~1"),this.dataPath="/"+a+this.dataPath),null!==b&&(b=b.replace(/~/g,"~0").replace(/\//g,"~1"),this.schemaPath="/"+b+this.schemaPath),null!==this.subErrors)for(var c=0;c<this.subErrors.length;c++)this.subErrors[c].prefixWith(a,b);return this};var m={},n=i();n.addLanguage("en-gb",l),n.tv4=n,"undefined"!=typeof module&&module.exports?module.exports=n:a.tv4=n}(this),exports.tv4=module.exports,module={exports:{}},module=void 0,function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.2";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return arguments.length<2||c?a[x.random(a.length-1)]:x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={},f=null==c?x.identity:B(c);return y(b,function(c,g){var h=f.call(d,c,g,b);a(e,h,c)}),e}};x.groupBy=C(function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h;return function(){f=this,e=arguments,g=new Date;var i=function(){var j=new Date-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e)))},j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e)),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),_exports.LazyLoad=LazyLoad}.call(_window,_exports,_window,window,_module={exports:{}}),void 0===window.JSON&&(window.JSON=_exports.JSON);var tv4=_exports.tv4,reqwest=_exports.reqwest,_=_exports._,LazyLoad=_exports.LazyLoad;delete _exports,Helpers.Ajax=function(){function a(a){return-1===a.indexOf("?")?"?":"&"}function b(a){var b=String(a).replace(/^\s+|\s+$/g,"").match(/^([^:\/?#]+:)?(\/\/(?:[^:@]*(?::[^:@]*)?@)?(([^:\/?#]*)(?::(\d*))?))?([^?#]*)(\?[^#]*)?(#[\s\S]*)?/);return b?{href:b[0]||"",protocol:b[1]||"",authority:b[2]||"",host:b[3]||"",hostname:b[4]||"",port:b[5]||"",pathname:b[6]||"",search:b[7]||"",hash:b[8]||""}:null}function c(a,c){function d(a){var b=[];return a.replace(/^(\.\.?(\/|$))+/,"").replace(/\/(\.(\/|$))+/g,"/").replace(/\/\.\.$/,"/../").replace(/\/?[^\/]*/g,function(a){"/.."===a?b.pop():b.push(a)}),b.join("").replace(/^\//,"/"===a.charAt(0)?"/":"")}return c=b(c||""),a=b(a||""),c&&a?(c.protocol||a.protocol)+(c.protocol||c.authority?c.authority:a.authority)+d(c.protocol||c.authority||"/"===c.pathname.charAt(0)?c.pathname:c.pathname?(a.authority&&!a.pathname?"/":"")+a.pathname.slice(0,a.pathname.lastIndexOf("/")+1)+c.pathname:a.pathname)+(c.protocol||c.authority||c.pathname?c.search:c.search||a.search)+c.hash:null}function d(a){var b,d,e=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,f=a.toLowerCase(),g=e.exec(f);try{b=location.href}catch(h){b=document.createElement("a"),b.href="",b=b.href}b=b.toLowerCase(),g||(f=c(b,f).toLowerCase(),g=e.exec(f)),d=e.exec(b)||[];var i=!(g&&(g[1]!==d[1]||g[2]!==d[2]||(g[3]||("http:"===g[1]?"80":"443"))!==(d[3]||("http:"===d[1]?"80":"443"))));return i}function e(a){return Math.floor(Math.random()*a)}return function(b,c){if(!b.url)throw"F2.Ajax: you must provide a url.";b.crossOrigin=!d(b.url),b.method||(b.crossOrigin?b.type="jsonp":b.method="post"),b.type||(b.type="json"),"get"!==b.method&&"jsonp"!==b.type||c||(b.url+=a(b.url)+e(1e6)),"jsonp"===b.type&&(b.jsonpCallbackName="F2_"+e(1e6),window[b.jsonpCallbackName]=function(a){b.success&&b.success(a),b.complete&&b.complete(),delete window[b.jsonpCallbackName]});var f=reqwest(b);return function(){var a={isAborted:!1};return a.abort=function(){a.isAborted=!0,f.request.abort()},a}()}},Helpers.AppPlaceholders=function(){function a(a){var b,d;if(a){var e=a.getAttribute("data-f2-appid"),f=a.getAttribute("data-f2-manifesturl");if(e&&f){d={appId:e,manifestUrl:f};var g=a.getAttribute("data-f2-context");if(g)try{d.context=JSON.parse(g)}catch(h){console.warn('F2: "data-f2-context" of node is not valid JSON','"'+h+'"')}for(var i in a.attributes)if(0===i.indexOf("data-f2-context-"))for(var j=i.replace("data-f2-context-","").split("-"),k=0,l=j.length;l>k;k++)if(k===l-1)try{d.context[j[k]]=JSON.parse(a.getAttribute(i))}catch(h){d.context[j[k]]=a.getAttribute(i)}else d.context[j[k]]={}}}if(d){var m=c(a);b={appConfig:d,isPreload:m,node:a}}return b}function b(a,b){var c=[];return function d(a){for(;a;)1===a.nodeType&&a.getAttribute(b)&&c.push(a),a.hasChildNodes()&&d(a.firstChild),a=a.nextSibling}(a),c}function c(a){var b=!1;if(a.hasChildNodes())for(var c=0,d=a.childNodes.length;d>c;c++)if(1===a.childNodes[c].nodeType){b=!0;break}return b}return{getInNode:function(c){for(var d=[],e=b(c,"data-f2-appid"),f=0,g=e.length;g>f;f++){var h=a(e[f]);h&&d.push(h)}return d}}},Helpers.Guid=function(){var a={};return function b(){var c="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"===a?b:3&b|8;return c.toString(16)});return a[c]&&(c=b()),a[c]=!0,c}},Helpers.LoadApps=function(Ajax,_,Schemas,Guid){function remove(a){delete appInstances[a]}function loadApps(a,b,c,d,e,f){function g(){delegateHtmlLoading(i,c,e,h)}for(var h,i=[],j=[],k=0,l=b.length;l>k;k++){var m={};b[k]&&Schemas.validate(b[k],"appConfig")&&(m.instanceId=Guid(),m.appConfig=b[k],b[k].root&&1===b[k].root.nodeType?(m.root=b[k].root,m.appContent={success:!0,data:b[k].context||{}}):b[k].manifestUrl&&j.push(m)),i.push(m)}return j.length?h=requestApps(a,j,function(){f&&f(),g()}):(f&&f(),g()),h||{}}function dumpAppsOnDom(){var a=Array.prototype.slice.call(arguments);if(a.length){for(var b=document.createDocumentFragment(),c=0,d=a.length;d>c;c++)a[c].root&&b.appendChild(a[c].root);document.body.appendChild(b)}}function delegateHtmlLoading(a,b,c,d){var e=[];if(d)for(var f=0,g=a.length;g>f;f++){var h=a[f].appConfig.manifestUrl;d[h]&&d[h].request.isAborted&&(a[f].isAborted=!0,e.push(f))}for(b?b.apply(window,a):dumpAppsOnDom.apply(window,a);e.length;)a.splice(e.pop(),1);initAppClasses(a,c)}function initAppClasses(a,b){var c=_.map(a,function(a){return a.appConfig.appId});c.length?require(c,function(){for(var c=Array.prototype.slice.apply(arguments),d=0,e=a.length;e>d;d++)try{var f=new c[d](a[d].instanceId,a[d].appConfig,a[d].appContent.data||{},a[d].root);f.init&&f.init(),appInstances[a[d].instanceId]=f}catch(g){console.error("F2: could not init",a[d].appConfig.appId,'"'+g.toString()+'"')}b&&b()}):b&&b()}function requestApps(a,b,c){for(var d={},e={},f=0,g=b.length;g>f;f++){var h=b[f].appConfig;e[h.manifestUrl]||(e[h.manifestUrl]={singles:[],batch:[]}),h.enableBatchRequests?e[h.manifestUrl].batch.push(b[f]):e[h.manifestUrl].singles.push(b[f])}var i=[],j=0;for(var k in e){d[k]=[];var l=e[k].singles.slice();e[k].batch.length&&l.push(e[k].batch),j+=l.length,_.each(l,function(b){_.isArray(b)||(b=[b]);var e=_.map(b,function(a){return a.appConfig}),f=Ajax({complete:function(){if(!--j){var b=combineAppManifests(i);loadStaticFiles(a,b.styles,b.scripts,b.inlineScripts,function(){c()})}},data:{params:JSON.stringify(e)},success:function(a){Schemas.validate(a,"appManifest")||(a={apps:[]},_.each(e,function(){a.apps.push({success:!1})})),_.each(a.apps,function(a,c){if(b[c].appContent=a,a.html){var d=document.createElement("div");d.innerHTML=a.html,b[c].root=d.firstChild}}),i.push(a)},type:"json",url:k});d[k]={apps:b,request:f}})}return d}function combineAppManifests(a){for(var b={apps:[],inlineScripts:[],scripts:[],styles:[]},c=0,d=a.length;d>c;c++)for(var e in b)for(var f=0,g=a[c][e].length;g>f;f++)b[e].push(a[c][e][f]);return b}function loadStaticFiles(a,b,c,d,e){function f(){g&&h&&e()}var g=!1,h=!1;loadStyles(a,b,function(){g=!0,f()}),loadScripts(a,c,function(){loadInlineScripts(d,function(){h=!0,f()})})}function loadInlineScripts(inlines,callback){if(inlines.length)try{eval(inlines.join(";"))}catch(e){console.error("Error loading inline scripts: "+e)}callback()}function loadScripts(a,b,c){_.isFunction(a.loadScripts)?a.loadScripts(b,c):require(b,function(){c()})}function loadStyles(a,b,c){if(_.isFunction(a.loadStyles))a.loadStyles(b,c);else{for(var d=document.getElementsByTagName("head")[0],e=0,f=b.length;f>e;e++){var g=document.createNode("link");g.rel="stylesheet",g.href=b[e],g.async=!1,d.appendChild(g)}c()}}var appInstances={};return{getInstance:function(a){var b;if(1===a.nodeType){for(var c in appInstances)if(appInstances[c].root===a){b=appInstances[c];break}}else b=appInstances[a];return b},load:loadApps,remove:remove}},define("F2.AppClass",["F2"],function(a){var b=function(a,b,c,d){this.instanceId=a,this.appConfig=b,this.context=c,this.root=d};return b.prototype={dispose:function(){},events:{many:function(b,c,d){return a.Events.many(b,c,d,this)},off:function(b,c){return a.Events.off(b,c,this)},on:function(b,c){return a.Events.on(b,c,this)},once:function(b,c){return a.Events.once(b,c,this)}},reload:function(b){var c=this;_.extend(this.appConfig.context,b),a.load(this.appConfig).then(function(b){b.root=c.root,a.remove(c.instanceId)})}},b}),Lib.Constants=function(){return{EVENTS:{APP_SYMBOL_CHANGE:"__appSymbolChange__",APP_WIDTH_CHANGE:"__appWidthChange__",CONTAINER_SYMBOL_CHANGE:"__containerSymbolChange__",CONTAINER_WIDTH_CHANGE:"__containerWidthChange__"},VIEWS:{ABOUT:"about",DATA_ATTRIBUTE:"data-f2-view",HELP:"help",HOME:"home",REMOVE:"remove",SETTINGS:"settings"}}},Lib.Core=function(a,b,c,d,e){var f={loadScripts:null,loadStyles:null,supportedViews:[],xhr:{dataType:null,type:null,url:null},ui:{modal:null,showLoading:null,hideLoading:null}};return{config:function(a){return a&&c.validate(a,"containerConfig")&&(f=b.defaults({},a,f)),f},guid:e,load:function(c){if(!c.appConfigs||b.isArray(c.appConfigs)&&!c.appConfigs.length)throw"F2: you must specify at least one AppConfig to load";b.isArray(c.appConfigs)||(c.appConfigs=[c.appConfigs]);var d=a.load(this.config(),c.appConfigs,c.success,c.error,c.complete,c.afterRequest);return{abort:function(){if(d)for(var a in d)d[a].request.abort()},requests:d}},remove:function(c){c=[].concat(c),b.each(c,function(b){if(!b)throw"F2: you must provide an instanceId or a root to remove an app";var c=a.getInstance(b);c&&c.instanceId?(c.dispose&&c.dispose(),d.off(null,null,c),c.root&&c.root.parentNode&&c.root.parentNode.removeChild(c.root),c.__f2Disposed__=!0,a.remove(c.instanceId)):console.warn("F2: could not find an app to remove")})}}},Lib.Events=function(){function a(a,b,d,e){if(!a)throw"F2.Events: you must provide an event name.";if(!b)throw"F2.Events: you must provide an event handler.";c[a]||(c[a]=[]),d===window&&(d=void 0),c[a].push({handler:b,context:d,timesLeft:e})}function b(a,d,e){if(!a&&!d&&!e)throw'F2.Events: "off" accepts the following combinations of parameters: name/handler, name/context, handler, context.';if(a&&!d&&!e)throw"F2.Events: you must pass either a handler or context along with name";if(c[a]&&(d||e))for(var f=c[a].length;f--;){var g=d&&c[a][f].handler===d,h=e&&c[a][f].context===e;(g||h)&&c[a].splice(f,1)}else if(e||d)for(var i in c)b(i,d,e)}var c={};return{emit:function(a,d){if(!a)throw"F2.Events: you must provide an event name to emit.";if(c[a]){d=Array.prototype.slice.call(arguments,1);for(var e=[],f=c[a].length;f--;){var g=c[a][f];g.context&&g.context.__f2Disposed__?e.push(g.context):(g.handler.apply(g.context||window,d),void 0!==g.timesLeft&&0===--g.timesLeft&&c[a].splice(f,1))}for(;e.length;)b(null,null,e.shift())}},many:function(b,c,d,e){if(c=c?parseInt(c,10):0,1>c)throw'F2.Events: "timesToListen" must be greater than 0.';return a(b,d,e,c)},off:function(a,c,d){return b(a,c,d)},on:function(b,c,d){return a(b,c,d)},once:function(b,c,d){return a(b,c,d,1)}}},Lib.Schemas=function(a){return{add:function(b,c){if(!b)throw"F2.Schemas: you must provide a schema name.";if(!c)throw"F2.Schemas: you must provide a schema.";if(a.getSchema(b))throw"F2.Schemas: "+b+" is already a registered schema.";return a.addSchema(b,c),!0},isDefined:function(b){return!!a.getSchemaMap()[b]},validate:function(b,c){if(!c)throw"F2.Schemas: you must provide a schema name.";var d=a.getSchema(c);if(!d)throw"F2.Schemas: unrecognized schema name.";return a.validate(b,d)}}},Lib.SchemaModels=function(a){var b={appConfig:{id:"appConfig",title:"App Config",type:"object",properties:{appId:{type:"string"},context:{type:"object"},manifestUrl:{type:"string"},enableBatchRequests:{type:"boolean"},views:{type:"array",items:{type:"string"}}},required:["appId"]},appContent:{id:"appContent",title:"App Content",type:"object",properties:{error:{type:"object"},data:{type:"object"},html:{type:"string"}}},appManifest:{id:"appManifest",title:"App Manifest",type:"object",properties:{scripts:{type:"array",items:{type:"string"}},styles:{type:"array",items:{type:"string"}},inlineScripts:{type:"array",items:{type:"string"}},apps:{type:"array",items:{$ref:"appContent"}}},required:["scripts","styles","inlineScripts","apps"]},containerConfig:{id:"containerConfig",title:"Container Config",type:"object",properties:{loadScripts:{type:"object"},loadStyles:{type:"object"},loadInlineScripts:{type:"object"},supportedViews:{type:"array",items:{type:"string"}},ui:{type:"object",properties:{modal:{type:"object"},toggleLoading:{type:"object"}}},xhr:{type:"object",properties:{dataType:{type:"object"},type:{type:"object"},url:{type:"object"},timeout:{type:"integer",minimum:0}}}}},uiModalParams:{id:"uiModalParams",title:"F2.UI Modal Parameters",type:"object",properties:{buttons:{type:"array",items:{type:"object",properties:{label:{type:"string"},handler:{type:"object"}},required:["label","handler"]}},content:{type:"string"},onClose:{type:"object"},title:{type:"string"}}}};
for(var c in b)a.add(c,b[c])},Lib.UI=function(a,b,c){return{modal:function(d){var e=a.config();e.ui&&b.isFunction(e.ui.modal)?b.isObject(d)&&c.validate(d,"uiModalParams")?e.ui.modal(d):console.error("F2.UI: The parameters to ui.modal are incorrect."):console.error("F2.UI: The container has not defined ui.modal.")},toggleLoading:function(c){var d=a.config();d.ui&&b.isFunction(d.ui.toggleLoading)?!c||c&&1===c.nodeType?d.ui.toggleLoading(c):console.error("F2.UI: the root passed was not a native DOM node."):console.error("F2.UI: The container has not defined ui.showLoading.")}}};var Ajax=Helpers.Ajax(),AppPlaceholders=Helpers.AppPlaceholders(),Guid=Helpers.Guid(),Constants=Lib.Constants(),Events=Lib.Events(),Schemas=Lib.Schemas(tv4);Lib.SchemaModels(Schemas);var LoadApps=Helpers.LoadApps(Ajax,_,Schemas,Guid),Core=Lib.Core(LoadApps,_,Schemas,Events,Guid),UI=Lib.UI(Core,_,Schemas),F2=function(){return{config:Core.config,load:Core.load,remove:Core.remove,guid:Core.guid,Events:{emit:Events.emit,on:Events.on,off:Events.off,once:Events.once,many:Events.many},Constants:Constants,addSchema:Schemas.add,hasSchema:Schemas.isDefined,validate:Schemas.validate,UI:{modal:UI.modal,toggleLoading:UI.toggleLoading}}};define("F2",[],function(){return new F2}),define("F2Factory",[],function(){return F2}),require(["F2"],function(a){var b=AppPlaceholders.getInNode(document.body);if(b.length){var c=_.map(b,function(a){return a.isPreload&&(a.appConfig.root=a.node),a.appConfig});a.load({appConfigs:c,success:function(){for(var a=Array.prototype.slice.call(arguments),c=0,d=a.length;d>c;c++)b[c].isPreload||b[c].node.parentNode.replaceChild(a[c].root,b[c].node)}})}})}();
//# sourceMappingURL=f2.min.map